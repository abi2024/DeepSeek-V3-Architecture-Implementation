2025-12-05 11:36:50,523 - INFO - Initializing Data Pipeline...
2025-12-05 11:36:51,678 - INFO - Vocab Size: 131 | Device: cpu
2025-12-05 11:36:51,678 - INFO - Constructing DeepSeek Architecture...
2025-12-05 11:36:54,976 - INFO - Starting training from step 0...
2025-12-05 11:36:55,044 - ERROR - Critical Error: shape '[8, 2048, 9, 85]' is invalid for input of size 12582912
Traceback (most recent call last):
  File "C:\Users\ANT-PC\ERA_V4\Session_14+Microscope\train.py", line 51, in main
    logits, loss, router_probs = model(xb, yb)
  File "C:\Users\ANT-PC\ERA_V4\Session_14+Microscope\venv\lib\site-packages\torch\nn\modules\module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ANT-PC\ERA_V4\Session_14+Microscope\venv\lib\site-packages\torch\nn\modules\module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ANT-PC\ERA_V4\Session_14+Microscope\src\model.py", line 206, in forward
    x, probs = layer(x)
  File "C:\Users\ANT-PC\ERA_V4\Session_14+Microscope\venv\lib\site-packages\torch\nn\modules\module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ANT-PC\ERA_V4\Session_14+Microscope\venv\lib\site-packages\torch\nn\modules\module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ANT-PC\ERA_V4\Session_14+Microscope\src\model.py", line 184, in forward
    h = x + self.self_attn(self.input_layernorm(x))
  File "C:\Users\ANT-PC\ERA_V4\Session_14+Microscope\venv\lib\site-packages\torch\nn\modules\module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\ANT-PC\ERA_V4\Session_14+Microscope\venv\lib\site-packages\torch\nn\modules\module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\ANT-PC\ERA_V4\Session_14+Microscope\src\model.py", line 56, in forward
    q = self.q_proj(x).view(B, L, self.num_heads, self.head_dim)
RuntimeError: shape '[8, 2048, 9, 85]' is invalid for input of size 12582912
